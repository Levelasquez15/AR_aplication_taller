<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <!-- LIBRERIAS LOCALES -->
  <script src="../js/aframe.min.js"></script>
  <script src="../js/aframe-ar.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/IdeaSpaceVR/aframe-particle-system-component@1.1.4/dist/aframe-particle-system-component.min.js"></script>


  <style>
    body {
      margin: 0;
      overflow: hidden;
    }

    .arjs-loader {
      position: absolute;
      z-index: 999;
      background: black;
      color: white;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.3rem;
    }
  </style>
</head>

<body>

<div class="arjs-loader" id="loader">
  Cargando Realidad Aumentada...
</div>

<a-scene
  embedded
  vr-mode-ui="enabled: false"
  renderer="logarithmicDepthBuffer: true;"
  arjs="sourceType: webcam; debugUIEnabled: false;"
  sound="autoplay: true"
>


  <!-- CARGAR SONIDOS -->
  <a-assets>
    <audio id="dinoSound" src="../sounds/dinosaur-roar-390283.mp3"></audio>
  </a-assets>

  <!-- MARKER 1 (.patt) -->
<a-marker
  type="pattern"
  url="../markers/pattern-marker.patt"
  id="marker1"
  smooth="true"
  smoothCount="5"
  emitevents="true"
>

  <!-- RADIO -->
<a-entity
  rotation="0 0 0"
  position="0 0.5 0"
  animation="property: rotation;
             to: 0 360 0;
             dur: 10000;
             loop: true;
             easing: linear"
>

    <!-- CUERPO PRINCIPAL DEL RADIO -->
    <a-box
      position="0 0 0"
      depth="0.8"
      height="0.5"
      width="1.2"
      color="#1a1a1a"
    ></a-box>

    <!-- PANTALLA LCD -->
    <a-box
      position="-0.25 0.05 -0.42"
      depth="0.02"
      height="0.2"
      width="0.4"
      color="#00ff00"
      animation="property: opacity;
                 from: 0.5;
                 to: 1;
                 dur: 1000;
                 loop: true;
                 dir: alternate"
    ></a-box>

    <!-- ALTAVOZ -->
    <a-cylinder
      position="0.35 0 -0.42"
      radius="0.15"
      height="0.02"
      color="#333333"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- REJILLA ALTAVOZ -->
    <a-circle
      position="0.35 0.01 -0.42"
      radius="0.12"
      color="#666666"
      rotation="90 0 0"
    ></a-circle>

    <!-- ANTENA -->
    <a-cylinder
      position="-0.5 0.4 0"
      radius="0.02"
      height="0.8"
      color="silver"
      animation="property: rotation;
                 from: 0 0 -15;
                 to: 0 0 15;
                 dur: 2000;
                 loop: true;
                 dir: alternate"
    ></a-cylinder>

    <!-- BOTÓN ENCENDIDO -->
    <a-cylinder
      position="0.1 0.27 0"
      radius="0.06"
      height="0.03"
      color="red"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- BOTÓN VOLUMEN + -->
    <a-cylinder
      position="-0.1 0.27 0"
      radius="0.05"
      height="0.03"
      color="#4a4a4a"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- BOTÓN VOLUMEN - -->
    <a-cylinder
      position="-0.25 0.27 0"
      radius="0.05"
      height="0.03"
      color="#4a4a4a"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- ASA -->
    <a-torus
      position="0 0.35 0"
      radius="0.25"
      radius-tubular="0.03"
      color="#1a1a1a"
      rotation="0 90 0"
    ></a-torus>

    <!-- ECUALIZADOR LED 1 -->
    <a-box
      position="-0.45 0.15 -0.42"
      depth="0.02"
      height="0.15"
      width="0.03"
      color="#00ff00"
      animation="property: scale;
                 from: 1 0.3 1;
                 to: 1 1 1;
                 dur: 300;
                 loop: true;
                 dir: alternate"
    ></a-box>

    <!-- ECUALIZADOR LED 2 -->
    <a-box
      position="-0.38 0.15 -0.42"
      depth="0.02"
      height="0.15"
      width="0.03"
      color="#00ff00"
      animation="property: scale;
                 from: 1 0.5 1;
                 to: 1 1 1;
                 dur: 400;
                 loop: true;
                 dir: alternate"
    ></a-box>

    <!-- ECUALIZADOR LED 3 -->
    <a-box
      position="-0.31 0.15 -0.42"
      depth="0.02"
      height="0.15"
      width="0.03"
      color="#00ff00"
      animation="property: scale;
                 from: 1 0.7 1;
                 to: 1 1 1;
                 dur: 350;
                 loop: true;
                 dir: alternate"
    ></a-box>

    <!-- LUZ LED ROJA -->
    <a-sphere
      position="0.5 0.2 -0.42"
      radius="0.03"
      color="#ff0000"
      animation="property: opacity;
                 from: 0.3;
                 to: 1;
                 dur: 800;
                 loop: true;
                 dir: alternate"
    ></a-sphere>

    <!-- STICKER/LOGO 1 -->
    <a-circle
      position="-0.1 -0.15 -0.42"
      radius="0.08"
      color="#ff00ff"
      rotation="90 0 0"
    ></a-circle>

    <!-- STICKER/LOGO 2 -->
    <a-ring
      position="0.2 -0.15 -0.42"
      radius-inner="0.05"
      radius-outer="0.08"
      color="#ffff00"
      rotation="90 0 0"
    ></a-ring>

    <!-- DETALLES DECORATIVOS (tornillos) -->
    <a-cylinder
      position="-0.55 0.2 -0.41"
      radius="0.02"
      height="0.01"
      color="#888888"
      rotation="90 0 0"
    ></a-cylinder>

    <a-cylinder
      position="-0.55 -0.2 -0.41"
      radius="0.02"
      height="0.01"
      color="#888888"
      rotation="90 0 0"
    ></a-cylinder>

    <a-cylinder
      position="0.55 0.2 -0.41"
      radius="0.02"
      height="0.01"
      color="#888888"
      rotation="90 0 0"
    ></a-cylinder>

    <a-cylinder
      position="0.55 -0.2 -0.41"
      radius="0.02"
      height="0.01"
      color="#888888"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- BORDE METALICO -->
    <a-ring
      position="0 0 -0.42"
      radius-inner="0.58"
      radius-outer="0.62"
      color="silver"
      rotation="90 0 0"
    ></a-ring>

    <!-- ONDAS DE SONIDO (partículas) -->
    <a-entity
      id="ondas"
      position="0.35 0 -0.5"
      particle-system="
        preset: dust;
        color: #00ff00,#00aa00;
        particleCount: 50;
        size: 0.1;
        velocityValue: 0 0 -2;
        accelerationValue: 0 0 0;
        direction: -1;
        lifetime: 2;
        blending: additive"
      visible="false"
    ></a-entity>

  </a-entity>

</a-marker>


<!-- MARKER 2 (HIRO) - PISTOLA -->
<a-marker preset="hiro" id="marker2">

  <!-- PISTOLA -->
  <a-entity 
    position="0 0.5 0" 
    rotation="0 90 0"
    animation="property: rotation;
               from: 0 90 0;
               to: 0 450 0;
               dur: 8000;
               loop: true;
               easing: linear"
  >

    <!-- CAÑÓN -->
    <a-cylinder
      position="0.5 0 0"
      radius="0.08"
      height="0.8"
      color="#2c2c2c"
      rotation="0 0 90"
    ></a-cylinder>

    <!-- INTERIOR DEL CAÑÓN -->
    <a-cylinder
      position="0.91 0 0"
      radius="0.06"
      height="0.03"
      color="#1a1a1a"
      rotation="0 0 90"
    ></a-cylinder>

    <!-- CUERPO/EMPUÑADURA -->
    <a-box
      position="0 0 0"
      depth="0.15"
      height="0.35"
      width="0.4"
      color="#1a1a1a"
    ></a-box>

    <!-- GATILLO -->
    <a-box
      position="-0.05 -0.2 0"
      depth="0.1"
      height="0.15"
      width="0.05"
      color="#ff4444"
      animation="property: rotation;
                 from: 0 0 0;
                 to: 15 0 0;
                 dur: 500;
                 loop: true;
                 dir: alternate"
    ></a-box>

    <!-- MANGO -->
    <a-box
      position="-0.1 -0.4 0"
      depth="0.12"
      height="0.3"
      width="0.15"
      color="#3a3a3a"
    ></a-box>

    <!-- MIRA DELANTERA -->
    <a-box
      position="0.8 0.15 0"
      depth="0.03"
      height="0.1"
      width="0.03"
      color="#ff9900"
    ></a-box>

    <!-- MIRA TRASERA -->
    <a-box
      position="0.1 0.15 -0.04"
      depth="0.03"
      height="0.08"
      width="0.03"
      color="#ff9900"
    ></a-box>

    <a-box
      position="0.1 0.15 0.04"
      depth="0.03"
      height="0.08"
      width="0.03"
      color="#ff9900"
    ></a-box>

    <!-- SEGURO -->
    <a-cylinder
      position="-0.15 0.08 0.08"
      radius="0.02"
      height="0.03"
      color="red"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- DETALLES DEL CAÑÓN (estrías) -->
    <a-ring
      position="0.7 0 0"
      radius-inner="0.08"
      radius-outer="0.09"
      color="#1a1a1a"
      rotation="0 90 0"
    ></a-ring>

    <a-ring
      position="0.6 0 0"
      radius-inner="0.08"
      radius-outer="0.09"
      color="#1a1a1a"
      rotation="0 90 0"
    ></a-ring>

    <a-ring
      position="0.5 0 0"
      radius-inner="0.08"
      radius-outer="0.09"
      color="#1a1a1a"
      rotation="0 90 0"
    ></a-ring>

    <!-- RIEL SUPERIOR (para mira táctica) -->
    <a-box
      position="0.3 0.19 0"
      depth="0.03"
      height="0.02"
      width="0.3"
      color="#3a3a3a"
    ></a-box>

    <!-- TEXTURA GRIP MANGO -->
    <a-box
      position="-0.1 -0.4 -0.07"
      depth="0.02"
      height="0.25"
      width="0.15"
      color="#222222"
    ></a-box>

    <a-box
      position="-0.1 -0.4 0.07"
      depth="0.02"
      height="0.25"
      width="0.15"
      color="#222222"
    ></a-box>

    <!-- TORNILLOS DECORATIVOS -->
    <a-cylinder
      position="0.05 0.12 0.08"
      radius="0.015"
      height="0.01"
      color="#666666"
      rotation="90 0 0"
    ></a-cylinder>

    <a-cylinder
      position="0.05 -0.08 0.08"
      radius="0.015"
      height="0.01"
      color="#666666"
      rotation="90 0 0"
    ></a-cylinder>

    <!-- EXPULSOR DE CASQUILLOS -->
    <a-box
      position="0.15 0.1 0.09"
      depth="0.03"
      height="0.03"
      width="0.02"
      color="#555555"
    ></a-box>

    <!-- LUZ LÁSER (opcional) -->
    <a-cylinder
      position="0.2 -0.12 0.09"
      radius="0.02"
      height="0.06"
      color="#ff0000"
      rotation="0 0 90"
      animation="property: opacity;
                 from: 0.5;
                 to: 1;
                 dur: 200;
                 loop: true;
                 dir: alternate"
    ></a-cylinder>

    <!-- DESTELLOS DE DISPARO -->
    <a-entity
      id="destello"
      position="0.95 0 0"
      particle-system="
        preset: dust;
        color: #ffff00,#ff6600,#ff0000;
        particleCount: 30;
        size: 0.2;
        velocityValue: 3 0 0;
        accelerationValue: -2 0 0;
        direction: 1;
        lifetime: 0.5;
        blending: additive"
      visible="false"
    ></a-entity>

  </a-entity>

</a-marker>


  <!-- MARKER 3 (KANJI) - CARRO -->
  <a-marker preset="kanji" id="marker3">
    
    <!-- CARRO -->
    <a-entity 
      position="0 0.5 0" 
      rotation="0 0 0"
      animation="property: position;
                 from: -1 0.5 0;
                 to: 1 0.5 0;
                 dur: 6000;
                 loop: true;
                 dir: alternate;
                 easing: easeInOutQuad"
    >

      <!-- CHASIS PRINCIPAL -->
      <a-box
        position="0 0 0"
        depth="1.2"
        height="0.3"
        width="0.6"
        color="#c41e3a"
      ></a-box>

      <!-- CAPÓ -->
      <a-box
        position="0 0.05 -0.7"
        depth="0.2"
        height="0.25"
        width="0.6"
        color="#c41e3a"
      ></a-box>

      <!-- PARABRISAS -->
      <a-box
        position="0 0.25 -0.5"
        depth="0.3"
        height="0.3"
        width="0.58"
        color="#87ceeb"
        opacity="0.6"
        rotation="20 0 0"
      ></a-box>

      <!-- TECHO -->
      <a-box
        position="0 0.35 0"
        depth="0.6"
        height="0.05"
        width="0.6"
        color="#c41e3a"
      ></a-box>

      <!-- VENTANAS LATERALES -->
      <a-box
        position="0.31 0.2 0"
        depth="0.5"
        height="0.2"
        width="0.02"
        color="#87ceeb"
        opacity="0.6"
      ></a-box>

      <a-box
        position="-0.31 0.2 0"
        depth="0.5"
        height="0.2"
        width="0.02"
        color="#87ceeb"
        opacity="0.6"
      ></a-box>

      <!-- VENTANA TRASERA -->
      <a-box
        position="0 0.25 0.5"
        depth="0.3"
        height="0.3"
        width="0.58"
        color="#87ceeb"
        opacity="0.6"
        rotation="-20 0 0"
      ></a-box>

      <!-- FAROS DELANTEROS -->
      <a-sphere
        position="0.25 -0.05 -0.82"
        radius="0.08"
        color="#ffff00"
        animation="property: opacity;
                   from: 0.7;
                   to: 1;
                   dur: 500;
                   loop: true;
                   dir: alternate"
      ></a-sphere>

      <a-sphere
        position="-0.25 -0.05 -0.82"
        radius="0.08"
        color="#ffff00"
        animation="property: opacity;
                   from: 0.7;
                   to: 1;
                   dur: 500;
                   loop: true;
                   dir: alternate"
      ></a-sphere>

      <!-- LUCES TRASERAS -->
      <a-sphere
        position="0.25 -0.05 0.62"
        radius="0.06"
        color="#ff0000"
      ></a-sphere>

      <a-sphere
        position="-0.25 -0.05 0.62"
        radius="0.06"
        color="#ff0000"
      ></a-sphere>

      <!-- RUEDA DELANTERA IZQUIERDA -->
      <a-cylinder
        position="0.35 -0.2 -0.4"
        radius="0.15"
        height="0.1"
        color="#1a1a1a"
        rotation="0 0 90"
        animation="property: rotation;
                   to: 0 0 450;
                   dur: 2000;
                   loop: true;
                   easing: linear"
      >
        <a-circle
          position="0.06 0 0"
          radius="0.08"
          color="#666666"
          rotation="0 90 0"
        ></a-circle>
      </a-cylinder>

      <!-- RUEDA DELANTERA DERECHA -->
      <a-cylinder
        position="-0.35 -0.2 -0.4"
        radius="0.15"
        height="0.1"
        color="#1a1a1a"
        rotation="0 0 90"
        animation="property: rotation;
                   to: 0 0 450;
                   dur: 2000;
                   loop: true;
                   easing: linear"
      >
        <a-circle
          position="0.06 0 0"
          radius="0.08"
          color="#666666"
          rotation="0 90 0"
        ></a-circle>
      </a-cylinder>

      <!-- RUEDA TRASERA IZQUIERDA -->
      <a-cylinder
        position="0.35 -0.2 0.4"
        radius="0.15"
        height="0.1"
        color="#1a1a1a"
        rotation="0 0 90"
        animation="property: rotation;
                   to: 0 0 450;
                   dur: 2000;
                   loop: true;
                   easing: linear"
      >
        <a-circle
          position="0.06 0 0"
          radius="0.08"
          color="#666666"
          rotation="0 90 0"
        ></a-circle>
      </a-cylinder>

      <!-- RUEDA TRASERA DERECHA -->
      <a-cylinder
        position="-0.35 -0.2 0.4"
        radius="0.15"
        height="0.1"
        color="#1a1a1a"
        rotation="0 0 90"
        animation="property: rotation;
                   to: 0 0 450;
                   dur: 2000;
                   loop: true;
                   easing: linear"
      >
        <a-circle
          position="0.06 0 0"
          radius="0.08"
          color="#666666"
          rotation="0 90 0"
        ></a-circle>
      </a-cylinder>

      <!-- ESPEJO RETROVISOR IZQUIERDO -->
      <a-box
        position="0.4 0.2 -0.3"
        depth="0.1"
        height="0.08"
        width="0.05"
        color="#1a1a1a"
      ></a-box>

      <!-- ESPEJO RETROVISOR DERECHO -->
      <a-box
        position="-0.4 0.2 -0.3"
        depth="0.1"
        height="0.08"
        width="0.05"
        color="#1a1a1a"
      ></a-box>

      <!-- PARACHOQUES DELANTERO -->
      <a-box
        position="0 -0.12 -0.92"
        depth="0.05"
        height="0.08"
        width="0.65"
        color="#333333"
      ></a-box>

      <!-- PARACHOQUES TRASERO -->
      <a-box
        position="0 -0.12 0.67"
        depth="0.05"
        height="0.08"
        width="0.65"
        color="#333333"
      ></a-box>

      <!-- HUMO DEL ESCAPE -->
      <a-entity
        id="humo"
        position="-0.25 -0.1 0.7"
        particle-system="
          preset: dust;
          color: #888888,#aaaaaa;
          particleCount: 20;
          size: 0.1;
          velocityValue: 0 0 1;
          accelerationValue: 0 0.5 0;
          lifetime: 1.5;
          blending: additive"
        visible="true"
      ></a-entity>

    </a-entity>

  </a-marker>

  <a-entity camera></a-entity>
</a-scene>

<script>
  const marker1 = document.querySelector("#marker1");
  const marker2 = document.querySelector("#marker2");
  const marker3 = document.querySelector("#marker3");
  const sonido = document.querySelector("#dinoSound");
  const ondas = document.querySelector("#ondas");
  const destello = document.querySelector("#destello");
  const humo = document.querySelector("#humo");

  // Radio con música
  marker1.addEventListener("markerFound", () => {
    sonido.currentTime = 0;
    sonido.play();
    ondas.setAttribute("visible", true);
  });

  marker1.addEventListener("markerLost", () => {
    sonido.pause();
    ondas.setAttribute("visible", false);
  });

  // Pistola con destellos
  marker2.addEventListener("markerFound", () => {
    destello.setAttribute("visible", true);
  });

  marker2.addEventListener("markerLost", () => {
    destello.setAttribute("visible", false);
  });

  // Carro con humo (siempre visible cuando se detecta el marker)
  marker3.addEventListener("markerFound", () => {
    if (humo) humo.setAttribute("visible", true);
  });

  marker3.addEventListener("markerLost", () => {
    if (humo) humo.setAttribute("visible", false);
  });
</script>



<script>
  window.addEventListener('load', () => {
    setTimeout(() => {
      const loader = document.getElementById('loader')
      if (loader) loader.style.display = 'none'
    }, 2000)
  })
</script>

</body>
</html>
