"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6203],{6203:(A,y,u)=>{u.r(y),u.d(y,{MyMarkersPageModule:()=>w});var M=u(2200),F=u(4341),s=u(7343),_=u(8132),p=u(467),e=u(3664),h=u(2615),C=u(3896),v=u(3690);let P=(()=>{var c;class i{constructor(){}generateARPattern(a){var n=this;return(0,p.A)(function*(){return new Promise((t,r)=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>{try{const l=n.createMarkerImage(o),d=n.generatePatternFile(o);l.toBlob(m=>{m?t({patternFile:d,markerImage:m}):r(new Error("Error generando el blob del marcador"))},"image/png")}catch(l){r(l)}},o.onerror=()=>{r(new Error("Error cargando la imagen"))},o.src=a})})()}createMarkerImage(a){const n=document.createElement("canvas"),t=n.getContext("2d"),r=512;n.width=r,n.height=r,t.fillStyle="#FFFFFF",t.fillRect(0,0,r,r);t.fillStyle="#000000",t.fillRect(0,0,r,r);t.fillStyle="#FFFFFF",t.fillRect(128,128,256,256);return t.drawImage(a,140.8,140.8,230.4,230.4),n}generatePatternFile(a){const n=document.createElement("canvas"),t=n.getContext("2d"),r=16;n.width=r,n.height=r,t.drawImage(a,0,0,r,r);const l=t.getImageData(0,0,r,r).data;let d="";for(let m=0;m<r;m++){for(let g=0;g<r;g++)d+=l[4*(m*r+g)]+" ";d+="\\n"}d+="\\n";for(let m=0;m<r;m++){for(let g=0;g<r;g++)d+=l[4*(m*r+g)+1]+" ";d+="\\n"}d+="\\n";for(let m=0;m<r;m++){for(let g=0;g<r;g++)d+=l[4*(m*r+g)+2]+" ";d+="\\n"}return d}downloadMarkerImage(a,n){const t=URL.createObjectURL(a),r=document.createElement("a");r.href=t,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}downloadPatternFile(a,n){const t=new Blob([a],{type:"text/plain"}),r=URL.createObjectURL(t),o=document.createElement("a");o.href=r,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}static#e=c=()=>(this.\u0275fac=function(n){return new(n||i)},this.\u0275prov=h.jDH({token:i,factory:i.\u0275fac,providedIn:"root"}))}return c(),i})();function O(c,i){1&c&&(e.j41(0,"div",19),e.nrm(1,"ion-spinner",20),e.j41(2,"p"),e.EFF(3,"Cargando marcadores..."),e.k0s()())}function x(c,i){if(1&c){const f=e.RV6();e.j41(0,"ion-card",23)(1,"div",24),e.nrm(2,"img",25),e.k0s(),e.j41(3,"ion-card-header")(4,"ion-card-subtitle"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"ion-card-title",26),e.EFF(8),e.k0s()(),e.j41(9,"ion-card-content")(10,"div",27)(11,"ion-button",28),e.bIt("click",function(){const n=h.eBV(f).$implicit,t=e.XpG(2);return h.Njj(t.downloadMarker(n))}),e.nrm(12,"ion-icon",29),e.EFF(13," Descargar "),e.k0s(),e.j41(14,"ion-button",30),e.bIt("click",function(){const n=h.eBV(f).$implicit,t=e.XpG(2);return h.Njj(t.shareMarker(n))}),e.nrm(15,"ion-icon",31),e.EFF(16," Compartir "),e.k0s(),e.j41(17,"ion-button",32),e.bIt("click",function(){const n=h.eBV(f).$implicit,t=e.XpG(2);return h.Njj(t.deleteMarker(n))}),e.nrm(18,"ion-icon",33),e.k0s()()()()}if(2&c){const f=i.$implicit;e.R7$(2),e.Y8G("src",f.url,e.B4B)("alt",f.name),e.R7$(3),e.JRh(e.i5U(6,4,f.created_at,"short")),e.R7$(3),e.JRh(f.name)}}function b(c,i){if(1&c&&(e.j41(0,"div",21),e.DNE(1,x,19,7,"ion-card",22),e.k0s()),2&c){const f=e.XpG();e.R7$(),e.Y8G("ngForOf",f.markers)}}function j(c,i){1&c&&(e.j41(0,"div",34),e.nrm(1,"ion-icon",35),e.j41(2,"h2"),e.EFF(3,"No tienes marcadores"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Crea tu primer marcador AR para comenzar"),e.k0s(),e.j41(6,"ion-button",36),e.nrm(7,"ion-icon",37),e.EFF(8," Crear Marcador "),e.k0s()())}function E(c,i){1&c&&(e.j41(0,"ion-card",38)(1,"ion-card-header")(2,"ion-card-title"),e.nrm(3,"ion-icon",39),e.EFF(4," C\xf3mo usar tus marcadores "),e.k0s()(),e.j41(5,"ion-card-content")(6,"ol")(7,"li")(8,"strong"),e.EFF(9,"Descarga"),e.k0s(),e.EFF(10," el marcador que quieras usar"),e.k0s(),e.j41(11,"li")(12,"strong"),e.EFF(13,"Impr\xedmelo"),e.k0s(),e.EFF(14," o mu\xe9stralo en otra pantalla"),e.k0s(),e.j41(15,"li"),e.EFF(16,"Ve a "),e.j41(17,"strong"),e.EFF(18,'"Iniciar Realidad Aumentada"'),e.k0s()(),e.j41(19,"li")(20,"strong"),e.EFF(21,"Apunta"),e.k0s(),e.EFF(22," la c\xe1mara al marcador impreso"),e.k0s(),e.j41(23,"li"),e.EFF(24,"\xa1Disfruta la experiencia AR! \u{1f389}"),e.k0s()()()())}const R=[{path:"",component:(()=>{var c;class i{constructor(a,n,t,r,o){this.storageService=a,this.authService=n,this.markerGeneratorService=t,this.alertController=r,this.loadingController=o,this.markers=[],this.isLoading=!1}ngOnInit(){this.loadMarkers()}loadMarkers(){var a=this;return(0,p.A)(function*(){const n=a.authService.currentUserValue;if(n){a.isLoading=!0;try{const t=yield a.storageService.listUserFiles(n.uid);t.success&&t.files&&(a.markers=t.files.filter(r=>".emptyFolderPlaceholder"!==r.name).map(r=>{const o=`${n.uid}/${r.name}`,l=`https://bsojrhxindljlgpuwvmv.supabase.co/storage/v1/object/public/Taller-ar/${o}`;return{name:r.name,url:l,path:o,created_at:r.created_at||r.updated_at,originalImageUrl:l}}))}catch(t){console.error("Error cargando marcadores:",t),yield a.showAlert("Error","No se pudieron cargar los marcadores")}finally{a.isLoading=!1}}else yield a.showAlert("Error","Debes estar autenticado")})()}downloadMarker(a){var n=this;return(0,p.A)(function*(){const t=yield n.loadingController.create({message:"Generando marcador AR...",spinner:"crescent"});yield t.present();try{const r=yield n.markerGeneratorService.generateARPattern(a.url),o=`marker_${a.name.replace(/\.[^/.]+$/,"")}.png`;n.markerGeneratorService.downloadMarkerImage(r.markerImage,o),yield new Promise(d=>setTimeout(d,500));const l=`pattern_${a.name.replace(/\.[^/.]+$/,"")}.patt`;n.markerGeneratorService.downloadPatternFile(r.patternFile,l),yield n.saveMarkerInfo(a),yield t.dismiss(),yield n.showAlert("\u2705 Marcador Listo",`\u{1f4e5} Se descargaron 2 archivos:\n\n1\ufe0f\u20e3 ${o} - Imprime este marcador\n\n2\ufe0f\u20e3 ${l} - Archivo de patr\xf3n\n\n\u{1f4f1} Cuando muestres el marcador a la c\xe1mara AR, ver\xe1s tu imagen original!`)}catch(r){yield t.dismiss(),yield n.showAlert("Error",r.message||"No se pudo generar el marcador")}})()}saveMarkerInfo(a){return(0,p.A)(function*(){const n=JSON.parse(localStorage.getItem("ar_markers")||"[]"),t={id:a.name.replace(/\.[^/.]+$/,""),imageUrl:a.originalImageUrl,markerImage:a.url,name:a.name},r=n.findIndex(o=>o.id===t.id);r>=0?n[r]=t:n.push(t),localStorage.setItem("ar_markers",JSON.stringify(n)),console.log("\u2705 Marcador guardado:",t)})()}shareMarker(a){var n=this;return(0,p.A)(function*(){if(navigator.share)try{yield navigator.share({title:"Marcador AR",text:`Mi marcador AR: ${a.name}`,url:a.url})}catch(t){console.log("Error compartiendo:",t)}else yield n.copyToClipboard(a.url),yield n.showAlert("Copiado","URL copiada al portapapeles")})()}copyToClipboard(a){return(0,p.A)(function*(){navigator.clipboard&&(yield navigator.clipboard.writeText(a))})()}deleteMarker(a){var n=this;return(0,p.A)(function*(){var r;yield(yield n.alertController.create({header:"Confirmar",message:`\xbfDeseas eliminar el marcador "${a.name}"?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"destructive",handler:(r=(0,p.A)(function*(){yield n.performDelete(a)}),function(){return r.apply(this,arguments)})}]})).present()})()}performDelete(a){var n=this;return(0,p.A)(function*(){const t=yield n.loadingController.create({message:"Eliminando...",spinner:"crescent"});yield t.present();try{const r=yield n.storageService.deleteFile(a.path);if(!r.success)throw new Error(r.error);yield n.showAlert("\xc9xito","Marcador eliminado"),yield n.loadMarkers()}catch(r){yield n.showAlert("Error",r.message||"No se pudo eliminar el marcador")}finally{yield t.dismiss()}})()}showAlert(a,n){var t=this;return(0,p.A)(function*(){yield(yield t.alertController.create({header:a,message:n,buttons:["OK"]})).present()})()}doRefresh(a){this.loadMarkers().then(()=>{a.target.complete()})}static#e=c=()=>(this.\u0275fac=function(n){return new(n||i)(e.rXU(C.n),e.rXU(v.u),e.rXU(P),e.rXU(s.hG),e.rXU(s.Xi))},this.\u0275cmp=e.VBU({type:i,selectors:[["app-my-markers"]],standalone:!1,decls:46,vars:6,consts:[[3,"translucent"],["slot","start"],["defaultHref","/home"],["slot","end"],["routerLink","/marker-generator"],["slot","icon-only","name","add-circle-outline"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"content-wrapper"],[1,"info-card"],[1,"info-content"],["name","information-circle","color","primary"],[2,"margin-left","15px","font-size","0.9em"],["href","https://github.com/jeromeetienne/AR.js/raw/master/data/images/HIRO.jpg","target","_blank"],["href","https://github.com/jeromeetienne/AR.js/raw/master/data/images/kanji.jpg","target","_blank"],["class","loading-container",4,"ngIf"],["class","markers-grid",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","instructions-card",4,"ngIf"],[1,"loading-container"],["name","crescent"],[1,"markers-grid"],["class","marker-card",4,"ngFor","ngForOf"],[1,"marker-card"],[1,"marker-image-container"],[3,"src","alt"],[1,"marker-name"],[1,"actions"],["fill","outline","size","small",3,"click"],["slot","start","name","download-outline"],["fill","outline","size","small","color","secondary",3,"click"],["slot","start","name","share-outline"],["fill","clear","size","small","color","danger",3,"click"],["slot","icon-only","name","trash-outline"],[1,"empty-state"],["name","image-outline","color","medium"],["routerLink","/marker-generator","color","primary"],["slot","start","name","add-circle-outline"],[1,"instructions-card"],["name","bulb-outline"]],template:function(n,t){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Mis Marcadores AR"),e.k0s(),e.j41(6,"ion-buttons",3)(7,"ion-button",4),e.nrm(8,"ion-icon",5),e.k0s()()()(),e.j41(9,"ion-content",6)(10,"ion-refresher",7),e.bIt("ionRefresh",function(o){return t.doRefresh(o)}),e.nrm(11,"ion-refresher-content"),e.k0s(),e.j41(12,"div",8)(13,"ion-card",9)(14,"ion-card-content")(15,"div",10),e.nrm(16,"ion-icon",11),e.j41(17,"div")(18,"p")(19,"strong"),e.EFF(20,"\u{1f3af} C\xf3mo usar m\xfaltiples marcadores:"),e.k0s()(),e.j41(21,"ol",12)(22,"li")(23,"strong"),e.EFF(24,"Primera imagen:"),e.k0s(),e.EFF(25," Usa el marcador HIRO (descargar "),e.j41(26,"a",13),e.EFF(27,"aqu\xed"),e.k0s(),e.EFF(28,")"),e.k0s(),e.j41(29,"li")(30,"strong"),e.EFF(31,"Segunda imagen:"),e.k0s(),e.EFF(32," Usa el marcador KANJI (descargar "),e.j41(33,"a",14),e.EFF(34,"aqu\xed"),e.k0s(),e.EFF(35,")"),e.k0s(),e.j41(36,"li"),e.EFF(37,"Imprime ambos marcadores"),e.k0s(),e.j41(38,"li"),e.EFF(39,"Ve a la c\xe1mara AR y apunta a cada marcador para ver su imagen correspondiente"),e.k0s(),e.j41(40,"li"),e.EFF(41,"\xa1Puedes mostrar los dos al mismo tiempo!"),e.k0s()()()()()(),e.DNE(42,O,4,0,"div",15)(43,b,2,1,"div",16)(44,j,9,0,"div",17)(45,E,25,0,"ion-card",18),e.k0s()()),2&n&&(e.Y8G("translucent",!0),e.R7$(9),e.Y8G("fullscreen",!0),e.R7$(33),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",!t.isLoading&&t.markers.length>0),e.R7$(),e.Y8G("ngIf",!t.isLoading&&0===t.markers.length),e.R7$(),e.Y8G("ngIf",t.markers.length>0))},dependencies:[M.Sq,M.bT,s.Jm,s.QW,s.b_,s.I9,s.ME,s.HW,s.tN,s.W9,s.eU,s.iq,s.To,s.Ki,s.w2,s.BC,s.ai,s.el,s.N7,_.Wk,M.vh],styles:[".content-wrapper[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:16px}.info-card[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:12px}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;flex-shrink:0}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--ion-color-medium);line-height:1.5}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.markers-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-bottom:20px}.marker-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden;margin:0}.marker-card[_ngcontent-%COMP%]   .marker-image-container[_ngcontent-%COMP%]{width:100%;height:200px;background:var(--ion-color-light);display:flex;align-items:center;justify-content:center;overflow:hidden}.marker-card[_ngcontent-%COMP%]   .marker-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.marker-card[_ngcontent-%COMP%]   .marker-name[_ngcontent-%COMP%]{font-size:1rem;word-break:break-word}.marker-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;align-items:center}.marker-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;min-width:100px}.marker-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:last-child{flex:0}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;text-align:center}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:80px;margin-bottom:20px}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:30px}.empty-state[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:10px}.instructions-card[_ngcontent-%COMP%]{border-radius:12px;margin-top:20px}.instructions-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:1.2rem}.instructions-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}.instructions-card[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{padding-left:20px;margin-top:10px}.instructions-card[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:12px;line-height:1.6}.instructions-card[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--ion-color-primary)}"]}))}return c(),i})()}];let I=(()=>{var c;class i{static#e=c=()=>(this.\u0275fac=function(n){return new(n||i)},this.\u0275mod=e.$C({type:i}),this.\u0275inj=h.G2t({imports:[_.iI.forChild(R),_.iI]}))}return c(),i})(),w=(()=>{var c;class i{static#e=c=()=>(this.\u0275fac=function(n){return new(n||i)},this.\u0275mod=e.$C({type:i}),this.\u0275inj=h.G2t({imports:[M.MD,F.YN,s.bv,I]}))}return c(),i})()}}]);